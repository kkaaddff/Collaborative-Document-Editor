# Collaborative MDX Editor

一个基于 Next.js 的实时协同文档编辑器，支持多用户同时编辑 MDX 文档。

## 功能特性

- ✅ **实时协同编辑**: 多用户可以同时编辑同一文档
- ✅ **加密传输**: 使用 AES 对称加密保护传输数据
- ✅ **冲突解决**: 实现操作变换算法处理编辑冲突
- ✅ **MDX 支持**: 完整的 MDX 编辑器，支持预览模式
- ✅ **用户状态**: 显示在线用户和实时光标位置
- ✅ **房间系统**: 通过代码加入或创建文档房间

## 技术栈

- **编辑器**: @mdxeditor/editor
- **实时通信**: webSocket
- **加密**: AES(网页侧、服务端对称加密)
- **冲突解决**: 自定义操作变换算法

## 使用方法

1. **创建文档**: 在首页点击 "Create New Document" 或输入自定义代码
2. **加入文档**: 输入文档代码和用户名加入已有文档
3. **协同编辑**: 多用户可以实时编辑，支持加粗、斜体、列表等格式
4. **安全传输**: 所有数据传输都经过 AES 加密

## 核心功能说明

### 加密通信

使用文档代码作为密钥，通过 AES 算法对所有传输内容进行加密：

```typescript
// 加密
const encrypted = encryptText(content, documentCode);

// 解密
const decrypted = decryptText(encrypted, documentCode);
```

### 操作变换算法

实现简单的 OT 算法处理并发编辑冲突：

- **插入操作**: 调整后续操作的插入位置
- **删除操作**: 调整删除范围，避免重复删除
- **混合操作**: 处理插入和删除同时发生的情况

### 房间管理

- 每个文档代码对应一个房间
- 自动清理超时空房间
- 实时同步用户状态

## 安全考虑

- 文档代码作为加密密钥，不要使用简单的代码
- 所有传输数据都经过加密
- 实施了基本的输入验证和错误处理

## 开发说明

### 扩展功能

1. **更复杂的 OT 算法**: 可以集成专业的 OT 库如 ShareJS
2. **持久化存储**: 添加数据库支持保存文档历史
3. **用户认证**: 集成登录系统
4. **版本控制**: 实现文档版本管理和回滚

### 调试

开发时可以在浏览器控制台查看 Socket.IO 连接状态和操作日志。
